\chapter{Evaluation}
\label{chp:eval}

\section{Experimental Setup}

The evaluation of the tool was performed on a local machine, using the Docker-based environment described in Chapter~\ref{chp:docker}.  
The environment consisted of:

\begin{itemize}
    \item Local machine running \textbf{Ubuntu 25.04};
    \item Docker container based on \textbf{Ubuntu 24.04};
    \item \textbf{Ghidra~11.4.2} (latest version at the time of evaluation);
    \item \textbf{Jadx~1.5.3} (latest version at the time of evaluation);
    \item \textbf{GhidraMCP~1.4} (latest version at the time of evaluation);
    \item \textbf{jadx-ai-mcp~4.0.0} (latest version at the time of evaluation).
\end{itemize}

\subsection{AWS for POIROT}

The extraction of crashes used for this evaluation is described in Chapter~\ref{chp:preliminaries}, and the corresponding execution environment is detailed in Chapter~\ref{chp:preliminaries_env}.  
All POIROT runs were executed on an AWS EC2 instance configured for large-scale fuzzing.

\subsection{LLM Used}

The evaluation was conducted using the OpenAI model GPT-5.1.

\section{Test Applications}

Table~\ref{tab:apps} lists the applications used for the evaluation, together with the exact versions of each APK.  
These apps were selected from the POIROT dataset and filtered based on the run performed. %The applications may have different versions in the POIROT dataset and this dataset. \textcolor{red}{Non so se tenere questa ultima frase per sengalare che le apks hanno versioni diverse}

\begin{table}[ht]
\centering
\resizebox{1\textwidth}{!}{
\begin{tabular}{|l|l||l|l|}
\hline
\multicolumn{4}{|c|}{\textbf{Applications Used for Evaluation}} \\
\hline
\textbf{App} & \textbf{Version} & \textbf{App} & \textbf{Version} \\
\hline
br.com.pedidos10 & 1.16.4 & ca.radioplayer.android & 6.3.420.1 \\
com.ahnlab.v3mobileplus & 2.5.20.10 & com.appgeneration.itunerfree & 9.3.13 \\
com.cisco.webex.meetings & 45.3.0 & com.clearchannel.iheartradio.controller & 10.36.0 \\
com.ford.fordpasseu & 4.23.1 & com.hyundaicard.cultureapp & 1.0.72 \\
com.intsig.BCRLite & 7.85.5 & com.jeju.genie & 2.2.13 \\
com.kbstar.kbbridge & 1.2.1 & com.kt.ktauth & 02.01.37 \\
com.lottemembers.android & 7.7.5 & com.more.dayzsurvival.gp & 25.1002.1 \\
com.pandora.android & 2509.1 & com.rockbite.deeptown & 6.2.10 \\
com.rstgames.durak & 1.9.11 & com.samsungcard.shopping & 1.4.901 \\
com.skmc.okcashbag.home\_google & 7.0.8 & com.skt.prod.dialer & 13.6.5 \\
com.skt.smartbill & 6.4.1 & com.sopheos.videgreniersmobile & 20.11.10 \\
com.ssg.serviceapp.android.egiftcertificate & 2.6.10 & com.teamjin.deliveryk & 7.0.3 \\
com.tencent.mm & 8.0.28 & com.tplink.skylight & 3.1.20 \\
fr.radioplayer.android & 6.6.420.1 & kr.co.busanbank.mbp & 3.0.10 \\
kr.co.morpheus.geps & 02.42 & kr.co.samsungcard.mpocket & 5.4.306 \\
kr.go.iros & 1.2.3 & kr.go.kcs.mobile.pubservice & 1.0.281 \\
kr.go.minwon.m & 2.5.95 & kr.go.nts.android & 12.8 \\
kr.go.wetax.android & 5.4.14 & nh.smart.allonebank & 1.8.8 \\
nh.smart.banking & 4.1.2 & nh.smart.card & 6.5.0 \\
nh.smart.nhcok & 2.0.70 & ragazzo.alphacode.com.br & 3.0.9 \\
tw.com.taishinbank.ccapp & 5.631 & tw.gov.tra.twtraffic & 2.1.2 \\
\hline
\end{tabular}
}
\caption{Applications evaluated by the triage system.}
\label{tab:apps}
\end{table}

\textcolor{red}{Devo scrivere quali sono lastversion e quali quelle di circa 2023? }

\section{Execution Time}

Table~\ref{tab:apps_time} reports the execution time for each application.  
The total time per APK depends primarily on the \emph{number of crashes} produced by POIROT, as well as the number of relevant libraries and the complexity of the stack trace.

\begin{table}[ht]
\centering
\resizebox{1\textwidth}{!}{
\begin{tabular}{|l|l||l|l|}
\hline
\multicolumn{4}{|c|}{\textbf{Execution LLM Time per Application}} \\
\hline
\textbf{App} & \textbf{Time (s)} & \textbf{App} & \textbf{Time (s)} \\
\hline
br.com.pedidos10 & 80 & ca.radioplayer.android & 480 \\ 
com.ahnlab.v3mobileplus & 338 & com.appgeneration.itunerfree & 113 \\ 
com.cisco.webex.meetings & 129 & com.clearchannel.iheartradio.controller & 200 \\ 
com.ford.fordpasseu & 185 & com.hyundaicard.cultureapp & 31 \\ 
com.intsig.BCRLite & 59 & com.jeju.genie & 0 \\ 
com.kbstar.kbbridge & 0 & com.kt.ktauth & 30 \\ 
com.lottemembers.android & 71 & com.more.dayzsurvival.gp & 0 \\ 
com.pandora.android & 420 & com.rockbite.deeptown & 17 \\ 
com.rstgames.durak & 49 & com.samsungcard.shopping & 0 \\ 
com.skmc.okcashbag.home\_google & 26 & com.skt.prod.dialer & 278 \\ 
com.skt.smartbill & 196 & com.sopheos.videgreniersmobile & 60 \\ 
com.ssg.serviceapp.android.egiftcertificate & 0 & com.teamjin.deliveryk & 83 \\ 
com.tencent.mm & 199 & com.tplink.skylight & 71 \\ 
fr.radioplayer.android & 628 & kr.co.busanbank.mbp & 403 \\ 
kr.co.morpheus.geps & 59 & kr.co.samsungcard.mpocket & 53 \\ 
kr.go.iros & 0 & kr.go.kcs.mobile.pubservice & 0 \\ 
kr.go.minwon.m & 30 & kr.go.nts.android & 67 \\ 
kr.go.wetax.android & 0 & nh.smart.allonebank & 0 \\ 
nh.smart.banking & 0 & nh.smart.card & 30 \\ 
nh.smart.nhcok & 0 & ragazzo.alphacode.com.br & 87 \\ 
tw.com.taishinbank.ccapp & 98 & tw.gov.tra.twtraffic & 78 \\ 
\hline
\hline
\multicolumn{2}{|r||}{\textbf{Average Time}} & \multicolumn{2}{l|}{\textbf{232.4}} \\
\hline
\end{tabular}
}
\caption{Approximate execution time per application.}
\label{tab:apps_time}
\end{table}

\section{\gls{llm} Usage}

\subsection{Tokens}

\glspl{llm}, when accessed through their cloud \glspl{api}, compute usage costs based on the number of \emph{input tokens} (the prompt sent to the model) and \emph{output tokens} (the generated response).  
Token consumption plays a central role in both performance and cost, and is influenced by several factors:


Token usage depends mainly on:

\begin{itemize}
    \item The prompt used, including both the system prompt and the user prompt;
    \item The number of crashes found by POIROT;
    \item The amount of decompiled code retrieved from Ghidra, which depends on the depth of the crash stack trace;
    \item The verbosity and structure of the triage explanation produced by the \gls{llm}.
\end{itemize}

Table~\ref{tab:apps_tokens} reports input and output token usage for each application.

\begin{table}[ht]
\centering
\resizebox{1\textwidth}{!}{
\begin{tabular}{|l|l|l||l|l|l|}
\hline
\multicolumn{6}{|c|}{\textbf{Token Usage per Application}} \\
\hline
\textbf{App} & \textbf{Input} & \textbf{Output} &
\textbf{App} & \textbf{Input} & \textbf{Output} \\
\hline
br.com.pedidos10 & 36344 & 4006 & ca.radioplayer.android & 494465 & 23484 \\ 
com.ahnlab.v3mobileplus & 392719 & 17831 & com.appgeneration.itunerfree & 53776 & 6516 \\ 
com.cisco.webex.meetings & 92548 & 7643 & com.clearchannel.iheartradio.controller & 151439 & 7039 \\ 
com.ford.fordpasseu & 84360 & 6811 & com.hyundaicard.cultureapp & 14113 & 1642 \\ 
com.intsig.BCRLite & 33230 & 4095 & com.jeju.genie & 0 & 0 \\ 
com.kbstar.kbbridge & 0 & 0 & com.kt.ktauth & 14265 & 2262 \\ 
com.lottemembers.android & 38747 & 2655 & com.more.dayzsurvival.gp & 0 & 0 \\ 
com.pandora.android & 70891 & 9638 & com.rockbite.deeptown & 6564 & 1421 \\ 
com.rstgames.durak & 56718 & 3376 & com.samsungcard.shopping & 0 & 0 \\ 
com.skmc.okcashbag.home\_google & 29282 & 1096 & com.skt.prod.dialer & 212223 & 12100 \\ 
com.skt.smartbill & 166934 & 10359 & com.sopheos.videgreniersmobile & 48392 & 3213 \\ 
com.ssg.serviceapp.android.egiftcertificate & 0 & 0 & com.teamjin.deliveryk & 31816 & 4143 \\ 
com.tencent.mm & 59455 & 13784 & com.tplink.skylight & 29527 & 4077 \\ 
fr.radioplayer.android & 202292 & 21668 & kr.co.busanbank.mbp & 226538 & 19492 \\ 
kr.co.morpheus.geps & 22248 & 1544 & kr.co.samsungcard.mpocket & 15476 & 1654 \\ 
kr.go.iros & 0 & 0 & kr.go.kcs.mobile.pubservice & 0 & 0 \\ 
kr.go.minwon.m & 14516 & 1378 & kr.go.nts.android & 40624 & 3648 \\ 
kr.go.wetax.android & 0 & 0 & nh.smart.allonebank & 0 & 0 \\ 
nh.smart.banking & 0 & 0 & nh.smart.card & 14111 & 1783 \\ 
nh.smart.nhcok & 0 & 0 & ragazzo.alphacode.com.br & 38671 & 3792 \\ 
tw.com.taishinbank.ccapp & 31781 & 4205 & tw.gov.tra.twtraffic & 42834 & 3530 \\ 
\hline
\hline
\multicolumn{3}{|r||}{\textbf{Average Input Tokens}} &
\multicolumn{3}{l|}{\textbf{138345}} \\
\multicolumn{3}{|r||}{\textbf{Average Output Tokens}} &
\multicolumn{3}{l|}{\textbf{10495}} \\
\hline
\end{tabular}
}
\caption{Input and output token usage per application.}
\label{tab:apps_tokens}
\end{table}

\subsection{Request}

\textcolor{red}{Spiegazioen llm request e llm tool calls}
        %"llm_requests": 0,
        %"llm_tool_calls": 0,


\begin{table}[ht]
\centering
\resizebox{1\textwidth}{!}{
\begin{tabular}{|l|l|l||l|l|l|}
\hline
\multicolumn{6}{|c|}{\textbf{Token Usage per Application}} \\
\hline
\textbf{App} & \textbf{Input} & \textbf{Output} &
\textbf{App} & \textbf{Input} & \textbf{Output} \\
\hline
br.com.pedidos10 & 5 & 9 & ca.radioplayer.android & 54 & 73 \\ 
com.ahnlab.v3mobileplus & 31 & 42 & com.appgeneration.itunerfree & 6 & 14 \\ 
com.cisco.webex.meetings & 10 & 23 & com.clearchannel.iheartradio.controller & 17 & 20 \\ 
com.ford.fordpasseu & 9 & 26 & com.hyundaicard.cultureapp & 2 & 3 \\ 
com.intsig.BCRLite & 4 & 9 & com.jeju.genie & 0 & 0 \\ 
com.kbstar.kbbridge & 0 & 0 & com.kt.ktauth & 2 & 3 \\ 
com.lottemembers.android & 2 & 5 & com.more.dayzsurvival.gp & 0 & 0 \\ 
com.pandora.android & 8 & 20 & com.rockbite.deeptown & 1 & 0 \\ 
com.rstgames.durak & 7 & 6 & com.samsungcard.shopping & 0 & 0 \\ 
com.skmc.okcashbag.home\_google & 4 & 3 & com.skt.prod.dialer & 26 & 26 \\ 
com.skt.smartbill & 21 & 27 & com.sopheos.videgreniersmobile & 6 & 10 \\ 
com.ssg.serviceapp.android.egiftcertificate & 0 & 0 & com.teamjin.deliveryk & 4 & 9 \\ 
com.tencent.mm & 36 & 29 & com.tplink.skylight & 4 & 9 \\ 
fr.radioplayer.android & 22 & 59 & kr.co.busanbank.mbp & 19 & 44 \\ 
kr.co.morpheus.geps & 3 & 4 & kr.co.samsungcard.mpocket & 2 & 5 \\ 
kr.go.iros & 0 & 0 & kr.go.kcs.mobile.pubservice & 0 & 0 \\ 
kr.go.minwon.m & 2 & 4 & kr.go.nts.android & 5 & 11 \\ 
kr.go.wetax.android & 0 & 0 & nh.smart.allonebank & 0 & 0 \\ 
nh.smart.banking & 0 & 0 & nh.smart.card & 2 & 3 \\ 
nh.smart.nhcok & 0 & 0 & ragazzo.alphacode.com.br & 5 & 13 \\ 
tw.com.taishinbank.ccapp & 4 & 10 & tw.gov.tra.twtraffic & 5 & 13 \\ 
\hline
\hline
\multicolumn{3}{|r||}{\textbf{Average LLM requests}} &
\multicolumn{3}{l|}{\textbf{16.4}} \\
\multicolumn{3}{|r||}{\textbf{Average LLM Tool Calls}} &
\multicolumn{3}{l|}{\textbf{26.6}} \\
\hline
\end{tabular}
}
\caption{Input and output token usage per application.}
\label{tab:apps_tokens}
\end{table}
        

\subsubsection{Evaluation Metrics}

\textcolor{red}{DA VEDERE se serve specificare le metriche}

For the evaluation, the F1-score was selected as the primary metric. This measure is commonly employed in classification settings because it offers a single value that reflects the trade-off between precision and recall, which is especially important when the distribution of classes is unbalanced or when both false positives and false negatives carry comparable weight. The F1-score is defined as:
\[
\mathrm{F1} = 2 \cdot \frac{\text{precision} \cdot \text{recall}}{\text{precision} + \text{recall}}
\]

Precision quantifies the proportion of correctly identified positive cases among all cases predicted as positive, whereas recall quantifies the proportion of actual positive cases that were successfully detected.  
The F1-score combines these two aspects through their harmonic mean, ensuring a lower score when precision and recall diverge significantly, even if one of the two is high.
